<ion-content [fullscreen]="true" scrollY="true">
  <div class="register-container">
    <div class="register-box">
      <h2>Crear una cuenta</h2>
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <ion-grid>
          <ion-row>

            <ion-col size="6">
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="Email" 
                  type="email" 
                  formControlName="email" 
                  autocomplete="off" 
                  required>
                </ion-input>
              </ion-item>
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="Usuario" 
                  type="text" 
                  formControlName="username" 
                  required>
                </ion-input>
              </ion-item>
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="Contraseña" 
                  [type]="showPassword ? 'text' : 'password'" 
                  formControlName="password" 
                  required>
                </ion-input>
                <ion-button slot="end" fill="clear" (click)="changePasswordVisibility()">
                  <ion-icon style="color: white;" [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
                </ion-button>
              </ion-item>
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="Repita contraseña" 
                  [type]="showPassword ? 'text' : 'password'"  
                  formControlName="confirmPassword" 
                  required>
                </ion-input>
                <ion-button slot="end" fill="clear" (click)="changePasswordVisibility()">
                  <ion-icon style="color: white;" [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
                </ion-button>
              </ion-item>
            </ion-col>

            <ion-col size="6">
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="Nombre" 
                  type="text" 
                  formControlName="name" 
                  required>
                </ion-input>
              </ion-item>
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="Apellidos" 
                  type="text" 
                  formControlName="surname" 
                  required>
                </ion-input>
              </ion-item>
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="DNI" 
                  type="text" 
                  formControlName="dni" 
                  required>
                </ion-input>
              </ion-item>
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="Teléfono" 
                  type="tel" 
                  formControlName="phone" 
                  required>
                </ion-input>
              </ion-item>
              <ion-item>
                <ion-input 
                  labelPlacement="floating" 
                  label="Edad" 
                  type="date" 
                  formControlName="age" 
                  required>
                </ion-input>
              </ion-item>
            </ion-col>
          </ion-row>
        </ion-grid>
        
        <!-- Mensajes de error -->
        <ion-text class="input-error" color="danger" *ngIf="name?.invalid && (name?.dirty || name?.touched)">
          <p *ngIf="name?.errors?.['required']">*Debe introducir su nombre</p>
          <p *ngIf="name?.errors?.['minlength']">*El nombre debe tener al menos dos caracteres</p>
        </ion-text>
        <ion-text class="input-error" color="danger" *ngIf="surname?.invalid && (surname?.dirty || surname?.touched)">
          <p *ngIf="surname?.errors?.['required']">*Debe introducir su/s apellido/s</p>
          <p *ngIf="surname?.errors?.['minlength']">*Su/s apellido/s debe/n tener al menos dos caracteres</p>
        </ion-text>
        <ion-text class="input-error" color="danger" *ngIf="dni?.invalid && (dni?.dirty || dni?.touched)">
          <p *ngIf="dni?.errors?.['required']">*Debe introducir su DNI</p>
          <p *ngIf="dni?.errors?.['pattern']">*El formato de DNI no es válido</p>
        </ion-text>
        <ion-text class="input-error" color="danger" *ngIf="phone?.invalid && (phone?.dirty || phone?.touched)">
          <p *ngIf="phone?.errors?.['required']">*Debe introducir su teléfono</p>
          <p *ngIf="phone?.errors?.['pattern']">*El formato del teléfono no es válido</p>
        </ion-text>
        <!--<ion-text class="input-error" color="danger" *ngIf="age?.invalid && (age?.dirty || age?.touched)">
          <p *ngIf="age?.errors?.['required']">*Debe introducir su edad</p>
          <p *ngIf="age?.errors?.['min']">*La edad debe ser al menos 18</p>
          <p *ngIf="age?.errors?.['max']">*La edad no puede ser mayor de 120</p>
        </ion-text>-->
        <ion-text class="input-error" color="danger" *ngIf="email?.invalid && (email?.dirty || email?.touched)">
          <p *ngIf="email?.errors?.['required']">*Debe introducir un email</p>
          <p *ngIf="email?.errors?.['email']">*Debe introducir un email correcto</p>
        </ion-text>
        <ion-text class="input-error" color="danger" *ngIf="password?.invalid && (password?.dirty || password?.touched)">
          <p *ngIf="password?.errors?.['required']">*Debe introducir una contraseña</p>
          <p *ngIf="password?.errors?.['passwordStrength']">*La contraseña debe tener al menos 8 caracteres, incluyendo mayúsculas, minúsculas, un número y un caracter especial</p>
        </ion-text>
        <ion-text class="input-error" color="danger" *ngIf="registerForm.errors?.['passwordsMismatch']">
          <p>*Las contraseñas no coinciden</p>
        </ion-text>
        
        <ion-button expand="block" type="submit" [disabled]="registerForm.invalid">
          Crear cuenta
        </ion-button>
      </form>
      
      <!-- Enlace para iniciar sesión -->
      <div class="login-link">
        <p>¿Ya tienes cuenta? <a [routerLink]="['/login']">Inicia sesión</a></p>
      </div>
    </div>
  </div>
</ion-content>
